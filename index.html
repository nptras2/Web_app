
        <!-- Eisenhower Matrix View -->
        <div id="matrix-view" class="hidden flex-1 overflow-y-auto p-6 w-full">
            <h1 class="text-xl font-semibold text-gray-800 mb-4">Eisenhower Matrix</h1>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 h-full">
                <!-- Urgent & Important -->
                <div class="border border-red-200 rounded-lg overflow-hidden">
                    <div class="bg-red-50 p-3 border-b border-red-200 flex items-center">
                        <div class="w-5 h-5 bg-red-500 rounded-full mr-2"></div>
                        <h2 class="font-medium text-red-800">Urgent & Important</h2>
                    </div>
                    <div class="p-3 overflow-y-auto max-h-96">
                        <div class="task-list" data-category="urgent-important">
                            <div class="text-center text-gray-500 py-4">No tasks</div>
                        </div>
                    </div>
                </div>
                
                <!-- Not Urgent & Important -->
                <div class="border border-yellow-200 rounded-lg overflow-hidden">
                    <div class="bg-yellow-50 p-3 border-b border-yellow-200 flex items-center">
                        <div class="w-5 h-5 bg-yellow-500 rounded-full mr-2"></div>
                        <h2 class="font-medium text-yellow-800">Not Urgent & Important</h2>
                    </div>
                    <div class="p-3 overflow-y-auto max-h-96">
                        <div class="task-list" data-category="not-urgent-important">
                            <div class="text-center text-gray-500 py-4">No tasks</div>
                        </div>
                    </div>
                </div>
                
                <!-- Urgent & Unimportant -->
                <div class="border border-blue-200 rounded-lg overflow-hidden">
                    <div class="bg-blue-50 p-3 border-b border-blue-200 flex items-center">
                        <div class="w-5 h-5 bg-blue-500 rounded-full mr-2"></div>
                        <h2 class="font-medium text-blue-800">Urgent & Unimportant</h2>
                    </div>
                    <div class="p-3 overflow-y-auto max-h-96">
                        <div class="task-list" data-category="urgent-unimportant">
                            <div class="text-center text-gray-500 py-4">No tasks</div>
                        </div>
                    </div>
                </div>
                
                <!-- Not Urgent & Unimportant -->
                <div class="border border-green-200 rounded-lg overflow-hidden">
                    <div class="bg-green-50 p-3 border-b border-green-200 flex items-center">
                        <div class="w-5 h-5 bg-green-500 rounded-full mr-2"></div>
                        <h2 class="font-medium text-green-800">Not Urgent & Unimportant</h2>
                    </div>
                    <div class="p-3 overflow-y-auto max-h-96">
                        <div class="task-list" data-category="not-urgent-unimportant">
                            <div class="text-center text-gray-500 py-4">No tasks</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TheCourtCase</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Task action dropdown menu */
        .task-actions-menu {
            position: absolute;
            right: 0;
            top: 100%;
            width: 240px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 100;
            padding: 8px 0;
            display: none;
            margin-top: 4px;
        }
        
        .task-actions-menu.active {
            display: block;
        }
        
        .task-actions-menu hr {
            border: none;
            border-top: 1px solid #f0f0f0;
            margin: 4px 0;
        }
        
        .task-actions-menu-item {
            display: flex;
            align-items: center;
            padding: 8px 16px;
            font-size: 14px;
            color: #333;
            cursor: pointer;
            white-space: nowrap;
        }
        
        .task-actions-menu-item:hover {
            background: #f5f5f5;
        }
        
        .task-actions-menu-item i {
            width: 20px;
            margin-right: 12px;
            text-align: center;
            color: #666;
        }
        
        .task-actions-menu-item .flag-icon {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            margin-right: 12px;
        }
        
        .task-actions-menu-item .flag-icon.red {
            background: #ef4444;
        }
        
        .task-actions-menu-item .flag-icon.blue {
            background: #3b82f6;
        }
        
        .task-actions-menu-item .flag-icon.yellow {
            background: #f59e0b;
        }
        
        .task-actions-menu-item .chevron {
            margin-left: auto;
            color: #999;
            font-size: 12px;
        }
        
        .task-actions-menu-submenu {
            position: absolute;
            left: 100%;
            top: 0;
            width: 200px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            padding: 8px 0;
            display: none;
        }
        
        .task-actions-menu-item:hover .task-actions-menu-submenu {
            display: block;
        }

        @media (max-width: 768px) {
            .mobile\:max-w-\[90vw\] {
                max-width: 90vw;
            }
            .mobile\:w-auto {
                width: auto;
            }
            .mobile\:mx-4 {
                margin-left: 1rem;
                margin-right: 1rem;
            }
            .mobile\:text-\[9px\] {
                font-size: 9px;
            }
            .mobile\:text-\[11px\] {
                font-size: 11px;
            }
            .mobile\:py-2 {
                padding-top: 0.5rem;
                padding-bottom: 0.5rem;
            }
            .mobile\:text-sm {
                font-size: 0.875rem;
            }
            .flex.h-screen {
                flex-direction: column;
            }
            .w-64 {
                width: 100%;
                height: auto;
            }
            .sidebar-item {
                padding: 12px 16px;
            }
            .header-content {
                flex-direction: column;
                align-items: flex-start;
                padding: 12px;
            }
            .search-bar {
                width: 100%;
                margin-top: 8px;
            }
            .task-item {
                padding: 8px 12px;
                min-height: 40px;
                flex-wrap: wrap;
            }
            .task-actions {
                width: 100%;
                margin-top: 8px;
                justify-content: flex-end;
            }
            .bottom-bar {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                z-index: 10;
            }
            .sidebar-toggle {
                display: block;
                position: fixed;
                bottom: 70px;
                right: 20px;
                z-index: 10;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                background: #3b82f6;
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            }
            .sidebar {
                position: fixed;
                top: 0;
                left: -100%;
                width: 80%;
                height: 100%;
                z-index: 20;
                transition: left 0.3s ease;
            }
            .sidebar.active {
                left: 0;
            }
            .sidebar-overlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                z-index: 15;
                display: none;
            }
            .sidebar-overlay.active {
                display: block;
            }
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Task checkbox animation */
        .task-checkbox:checked + .task-text {
            text-decoration: line-through;
            color: #9ca3af;
        }
        
        /* Sidebar animation */
        .sidebar-item:hover {
            background-color: rgba(59, 130, 246, 0.1);
        }

        /* Active tag styling */
        .sidebar-item.active-tag {
            background-color: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }
        .sidebar-item.active-tag i {
            color: inherit !important;
        }
        
        /* Compact task layout - global styling */
        .task-item {
            align-items: center;
            min-height: 36px !important;
            padding: 6px 12px !important;
        }
        
        .task-text {
            line-height: 1.2;
            font-size: 13px;
        }
        
        .task-item .text-xs {
            font-size: 11px;
            margin-top: 0;
        }
        
        .task-item .fa-flag,
        .task-item .fa-comment,
        .task-item .fa-ellipsis-h {
            font-size: 12px;
        }
        
        .task-item:hover {
            background-color: #f8fafc;
        }
        
        /* Custom checkbox */
        .custom-checkbox {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border: 2px solid #d1d5db;
            border-radius: 4px;
            outline: none;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
            margin-top: 1px;
        }
        
        .custom-checkbox:checked {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }
        
        .custom-checkbox:checked::after {
            content: '\2713';
            position: absolute;
            color: white;
            font-size: 14px;
            left: 3px;
            top: -1px;
        }

        /* Completed task styling - compact */
        .completed-task {
            opacity: 0.8;
            background-color: #f9fafb;
            min-height: 36px !important;
        }
        .completed-task .task-text {
            text-decoration: line-through;
            color: #9ca3af;
            font-size: 13px;
        }

        /* Calendar popup styling */
        .calendar-popup {
            transform-origin: left top;
        }
        
        @media (max-width: 768px) {
            .calendar-popup {
                width: 90vw !important;
                max-width: 300px !important;
                left: 1rem !important;
                right: 1rem !important;
                margin: 0 auto;
            }
            
            .calendar-popup .bg-white {
                width: 100% !important;
            }
        }

        /* Animation for moving tasks */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.3s ease forwards;
        }

        /* Eisenhower Matrix Styles */
        #matrix-view {
            min-height: calc(100vh - 120px);
        }
        
        #matrix-view .grid {
            min-height: calc(100vh - 200px);
        }
        .flex-1.flex.flex-col {
            margin-bottom: 4rem;
        }
        
        #matrix-view .task-list {
            min-height: 200px;
        }
        
        @media (max-width: 768px) {
            #matrix-view .grid {
                grid-template-columns: 1fr;
                min-height: auto;
            }
            
            #matrix-view .task-list {
                min-height: 150px;
            }
        }

        /* Collapsible sections */
        .collapsible-content {
            transition: max-height 0.3s ease;
            overflow: hidden;
        }
        .collapsible-content.collapsed {
            max-height: 0 !important;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <div class="flex h-screen overflow-hidden">
        <!-- Mobile Sidebar Toggle -->
        <div class="sidebar-toggle md:hidden fixed top-4 left-4 z-20 w-10 h-10 bg-white rounded-full shadow-md flex items-center justify-center cursor-pointer">
            <i class="fas fa-bars text-gray-700"></i>
        </div>
        
        <!-- Mobile Add Task Button -->
        <div class="add-task-button md:hidden fixed bottom-16 right-4 z-20 w-14 h-14 bg-blue-500 rounded-full shadow-md flex items-center justify-center cursor-pointer">
            <i class="fas fa-plus text-white text-xl"></i>
        </div>
        
        <!-- Sidebar Overlay -->
        <div class="sidebar-overlay"></div>
        
        <!-- Sidebar -->
        <div class="w-64 bg-white border-r border-gray-200 flex flex-col sidebar">
            <!-- Logo -->
            <div class="p-4 border-b border-gray-200">
                <div class="flex items-center">
                    <div class="w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center">
                        <i class="fas fa-check text-white"></i>
                    </div>
                    <span class="ml-2 text-xl font-bold text-gray-800">TheCourtCase</span>
                </div>
            </div>
            
            <!-- User profile -->
            <div class="p-4 border-b border-gray-200 flex items-center relative profile-section">
                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-user text-blue-500"></i>
                </div>
                <div class="ml-3">
                    <div class="text-sm font-medium text-gray-800">John Doe</div>
                    <div class="text-xs text-gray-500">Free Plan</div>
                </div>
                
                <!-- Profile popup menu -->
                <div class="profile-popup absolute left-0 right-0 top-full mt-1 bg-white shadow-lg rounded-md border border-gray-200 z-30 hidden">
                    <div class="py-1">
                        <div class="profile-menu-item px-4 py-2 flex items-center hover:bg-gray-100 cursor-pointer">
                            <i class="fas fa-cog text-gray-500 mr-3 w-4"></i>
                            <span>Settings</span>
                        </div>
                        <div class="profile-menu-item px-4 py-2 flex items-center hover:bg-gray-100 cursor-pointer">
                            <i class="fas fa-chart-bar text-gray-500 mr-3 w-4"></i>
                            <span>Statistics</span>
                        </div>
                        <div class="profile-menu-item px-4 py-2 flex items-center hover:bg-gray-100 cursor-pointer">
                            <i class="fas fa-crown text-yellow-500 mr-3 w-4"></i>
                            <span>Premium</span>
                        </div>
                        <div class="profile-menu-item px-4 py-2 flex items-center hover:bg-gray-100 cursor-pointer text-red-500">
                            <i class="fas fa-sign-out-alt mr-3 w-4"></i>
                            <span>Sign Out</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main navigation -->
            <div class="flex-1 overflow-y-auto">
                <div class="py-2">
                    <div class="sidebar-item px-4 py-2 flex items-center text-gray-700 cursor-pointer" data-view="inbox">
                        <i class="fas fa-inbox text-gray-500 w-6"></i>
                        <span class="ml-3">Inbox</span>
                    </div>
                    <div class="sidebar-item px-4 py-2 flex items-center text-blue-600 bg-blue-50 cursor-pointer" data-view="today">
                        <i class="fas fa-calendar-day text-blue-500 w-6"></i>
                        <span class="ml-3">Today</span>
                    </div>
                    <div class="sidebar-item px-4 py-2 flex items-center text-gray-700 cursor-pointer" data-view="week">
                        <i class="fas fa-calendar-week text-gray-500 w-6"></i>
                        <span class="ml-3">Next 7 Days</span>
                    </div>
                </div>
                
                <!-- Projects -->
                <div class="py-2 border-t border-gray-200 projects-section">
                    <div class="px-4 py-2 flex items-center justify-between text-gray-500 cursor-pointer project-header">
                        <div class="flex items-center">
                            <i class="fas fa-list-ul w-6"></i>
                            <span class="ml-3">Projects</span>
                        </div>
                        <i class="fas fa-plus cursor-pointer"></i>
                    </div>
                    <div class="pl-10 pr-4 py-1 project-content hidden">
                        <div class="sidebar-item px-2 py-2 flex items-center text-gray-700 cursor-pointer">
                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                            <span class="ml-3">Work</span>
                        </div>
                        <div class="sidebar-item px-2 py-2 flex items-center text-gray-700 cursor-pointer">
                            <div class="w-3 h-3 rounded-full bg-purple-500"></div>
                            <span class="ml-3">Personal</span>
                        </div>
                        <div class="sidebar-item px-2 py-2 flex items-center text-gray-700 cursor-pointer">
                            <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                            <span class="ml-3">Shopping</span>
                        </div>
                    </div>
                </div>
                
                <!-- Tags -->
                <div class="py-2 border-t border-gray-200 tags-section">
                    <div class="px-4 py-2 flex items-center justify-between text-gray-500 cursor-pointer tag-header">
                        <div class="flex items-center">
                            <i class="fas fa-tag w-6"></i>
                            <span class="ml-3">Tags</span>
                        </div>
                        <i class="fas fa-plus cursor-pointer"></i>
                    </div>
                    <div class="pl-10 pr-4 py-1 tag-content hidden">
                        <div class="sidebar-item px-2 py-2 flex items-center text-gray-700 cursor-pointer">
                            <i class="fas fa-circle text-red-500 text-xs"></i>
                            <span class="ml-3">Important</span>
                        </div>
                        <div class="sidebar-item px-2 py-2 flex items-center text-gray-700 cursor-pointer">
                            <i class="fas fa-circle text-blue-500 text-xs"></i>
                            <span class="ml-3">Work</span>
                        </div>
                    </div>
                </div>
                
                <!-- Settings -->
                <div class="py-2 border-t border-gray-200 settings-section">
                    <div class="sidebar-item px-4 py-2 flex items-center text-gray-700 cursor-pointer">
                        <i class="fas fa-cog text-gray-500 w-6"></i>
                        <span class="ml-3">Settings</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Main content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Header -->
            <div class="bg-white border-b border-gray-200 p-4 flex items-center justify-between header-content">
                <div class="flex items-center">
                    <h1 class="text-xl font-semibold text-gray-800">Today</h1>
                    <div class="ml-4 text-sm text-gray-500">Tue, Jun 6</div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <input type="text" placeholder="Search..." class="pl-8 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                    </div>
                    <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center cursor-pointer">
                        <i class="fas fa-bell text-gray-500"></i>
                    </div>
                    <div class="w-8 h-8 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center cursor-pointer theme-toggle">
                        <i class="fas fa-moon text-gray-500 dark:text-gray-300"></i>
                    </div>
                </div>
            </div>
            
            <!-- Content area -->
            <div class="flex-1 overflow-y-auto p-6">
                <!-- Add task input -->
                <div class="mb-6 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                    <div class="flex items-center p-3 border-b border-gray-200">
                        <input type="checkbox" class="custom-checkbox opacity-0 cursor-pointer">
                        <input type="text" id="new-task-input" placeholder="Add a task..." class="ml-3 flex-1 outline-none text-gray-700 placeholder-gray-400 mr-12">
                        <div class="flex items-center space-x-2 text-gray-400 ml-4">
                            <i class="fas fa-calendar cursor-pointer hover:text-blue-500" id="task-calendar-icon"></i>
                            <i class="fas fa-flag cursor-pointer hover:text-red-500"></i>
                            <button id="add-task-btn" class="px-4 py-1 bg-blue-500 text-white rounded-md text-sm hover:bg-blue-600">Add Task</button>
                        </div>
                    </div>
                </div>
                
                <!-- Task list -->
                <div class="space-y-2">
                    <!-- Task group header -->
                    <div class="flex items-center justify-between text-gray-500 text-sm mb-2">
                        <div class="flex items-center cursor-pointer group-toggle" data-target="overdue-tasks">
                            <i class="fas fa-chevron-down mr-2"></i>
                            <span>OVERDUE</span>
                        </div>
                        <span class="task-count" data-target="overdue-tasks">2 tasks</span>
                    </div>
                    
                    <!-- Overdue tasks -->
                    <div id="overdue-tasks" class="collapsible-content bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                        <div class="task-item p-2 border-b border-gray-200 flex items-center hover:bg-gray-50" data-id="task-1">
                            <input type="checkbox" class="task-checkbox custom-checkbox">
                            <div class="ml-2 flex-1">
                                <div class="task-text text-gray-800">Complete project proposal</div>
                                <div class="flex items-center text-xs text-gray-500">
                                    <div class="flex items-center text-red-500">
                                        <i class="far fa-calendar mr-1"></i>
                                        <span>Yesterday</span>
                                    </div>
                                    <div class="ml-4 flex items-center">
                                        <i class="fas fa-tag mr-1 text-purple-500"></i>
                                        <span>Work</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-1 text-gray-400 text-sm">
                                <i class="fas fa-flag text-red-500 cursor-pointer"></i>
                                <i class="far fa-comment cursor-pointer hover:text-yellow-500"></i>
                                <i class="fas fa-ellipsis-h cursor-pointer hover:text-gray-600"></i>
                            </div>
                        </div>
                        <div class="task-item p-3 border-b border-gray-200 flex items-center hover:bg-gray-50" data-id="task-2">
                            <input type="checkbox" class="task-checkbox custom-checkbox">
                            <div class="ml-3 flex-1">
                                <div class="task-text text-gray-800">Call with client about requirements</div>
                                <div class="flex items-center mt-1 text-xs text-gray-500">
                                    <div class="flex items-center text-red-500">
                                        <i class="far fa-calendar mr-1"></i>
                                        <span>Jun 4</span>
                                    </div>
                                    <div class="ml-4 flex items-center">
                                        <i class="fas fa-tag mr-1 text-blue-500"></i>
                                        <span>Work</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2 text-gray-400">
                                <i class="fas fa-flag text-red-500 cursor-pointer"></i>
                                <i class="far fa-comment cursor-pointer hover:text-yellow-500"></i>
                                <i class="fas fa-ellipsis-h cursor-pointer hover:text-gray-600"></i>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Today's tasks -->
                    <div class="mt-6 flex items-center justify-between text-gray-500 text-sm mb-2">
                        <div class="flex items-center cursor-pointer group-toggle" data-target="today-tasks">
                            <i class="fas fa-chevron-down mr-2"></i>
                            <span>TODAY</span>
                        </div>
                        <span class="task-count" data-target="today-tasks">3 tasks</span>
                    </div>
                    
                    <div id="today-tasks" class="collapsible-content bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                        <div class="task-item p-2 border-b border-gray-200 flex items-center hover:bg-gray-50" data-id="task-3">
                            <input type="checkbox" class="task-checkbox custom-checkbox">
                            <div class="ml-2 flex-1">
                                <div class="task-text text-gray-800">Team meeting at 10:00 AM</div>
                                <div class="flex items-center text-xs text-gray-500">
                                    <div class="flex items-center">
                                        <i class="far fa-clock mr-1"></i>
                                        <span>10:00 AM</span>
                                    </div>
                                    <div class="ml-4 flex items-center">
                                        <i class="fas fa-tag mr-1 text-blue-500"></i>
                                        <span>Work</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2 text-gray-400">
                                <i class="fas fa-flag text-red-500 cursor-pointer"></i>
                                <i class="far fa-comment cursor-pointer hover:text-yellow-500"></i>
                                <i class="fas fa-ellipsis-h cursor-pointer hover:text-gray-600"></i>
                            </div>
                        </div>
                        <div class="task-item p-3 border-b border-gray-200 flex items-center hover:bg-gray-50" data-id="task-4">
                            <input type="checkbox" class="task-checkbox custom-checkbox">
                            <div class="ml-3 flex-1">
                                <div class="task-text text-gray-800">Buy groceries for the week</div>
                                <div class="flex items-center mt-1 text-xs text-gray-500">
                                    <div class="flex items-center">
                                        <i class="far fa-calendar mr-1"></i>
                                        <span>Today</span>
                                    </div>
                                    <div class="ml-4 flex items-center">
                                        <i class="fas fa-tag mr-1 text-yellow-500"></i>
                                        <span>Shopping</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2 text-gray-400">
                                <i class="fas fa-flag text-gray-300 cursor-pointer hover:text-red-500"></i>
                                <i class="far fa-comment cursor-pointer hover:text-yellow-500"></i>
                                <i class="fas fa-ellipsis-h cursor-pointer hover:text-gray-600"></i>
                            </div>
                        </div>
                        <div class="task-item p-3 flex items-center hover:bg-gray-50" data-id="task-5">
                            <input type="checkbox" class="task-checkbox custom-checkbox">
                            <div class="ml-3 flex-1">
                                <div class="task-text text-gray-800">Read 30 pages of new book</div>
                                <div class="flex items-center mt-1 text-xs text-gray-500">
                                    <div class="flex items-center">
                                        <i class="far fa-calendar mr-1"></i>
                                        <span>Today</span>
                                    </div>
                                    <div class="ml-4 flex items-center">
                                        <i class="fas fa-tag mr-1 text-purple-500"></i>
                                        <span>Personal</span>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2 text-gray-400">
                                <i class="fas fa-flag text-gray-300 cursor-pointer hover:text-red-500"></i>
                                <i class="far fa-comment cursor-pointer hover:text-yellow-500"></i>
                                <i class="fas fa-ellipsis-h cursor-pointer hover:text-gray-600"></i>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Completed tasks section -->
                    <div class="mt-6">
                        <div class="flex items-center justify-between text-gray-500 text-sm mb-2">
                            <div class="flex items-center cursor-pointer group-toggle" data-target="completed-tasks">
                                <i class="fas fa-chevron-down mr-2"></i>
                                <span>COMPLETED</span>
                            </div>
                            <span class="task-count" data-target="completed-tasks">0 tasks</span>
                        </div>
                        <div id="completed-tasks" class="collapsible-content bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden" style="max-height: none;"></div>
                    </div>
                </div>
            </div>
            
            <!-- Bottom bar - Always visible -->
            <div class="bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 fixed bottom-0 left-0 right-0 z-50 h-16">
                <div class="flex justify-around items-center p-2">
                    <div class="flex flex-col items-center cursor-pointer group" data-tab="tasks">
                        <div class="w-6 h-6 flex items-center justify-center text-gray-500 dark:text-gray-400 group-hover:text-blue-500">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <span class="text-xs text-gray-500 dark:text-gray-400 group-hover:text-blue-500">Tasks</span>
                    </div>
                    <div class="flex flex-col items-center cursor-pointer group" data-tab="calendar">
                        <div class="w-6 h-6 flex items-center justify-center text-gray-500 dark:text-gray-400 group-hover:text-blue-500">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <span class="text-xs text-gray-500 dark:text-gray-400 group-hover:text-blue-500">Calendar</span>
                    </div>
                    <div class="flex flex-col items-center cursor-pointer group" data-tab="pomo">
                        <div class="w-6 h-6 flex items-center justify-center text-gray-500 dark:text-gray-400 group-hover:text-blue-500">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        <span class="text-xs text-gray-500 dark:text-gray-400 group-hover:text-blue-500">Pomo</span>
                    </div>
                    <div class="flex flex-col items-center cursor-pointer group" data-tab="matrix">
                        <div class="w-6 h-6 flex items-center justify-center text-gray-500 dark:text-gray-400 group-hover:text-blue-500">
                            <i class="fas fa-th-large"></i>
                        </div>
                        <span class="text-xs text-gray-500 dark:text-gray-400 group-hover:text-blue-500">Matrix</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Modal functions
        function showReminderModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-xl w-96 max-w-full">
                    <div class="p-4 border-b border-gray-200 flex justify-between items-center">
                        <h3 class="text-lg font-medium">Set Reminder</h3>
                        <button class="text-gray-500 hover:text-gray-700 close-modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="p-4 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Reminder Time</label>
                            <input type="datetime-local" class="w-full border border-gray-300 rounded-md p-2">
                        </div>
                    </div>
                    <div class="p-4 border-t border-gray-200 flex justify-end space-x-2">
                        <button class="px-4 py-2 border border-gray-300 rounded-md close-modal">Cancel</button>
                        <button class="px-4 py-2 bg-blue-500 text-white rounded-md" id="save-reminder">Set Reminder</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            modal.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', () => modal.remove());
            });

            modal.querySelector('#save-reminder').addEventListener('click', () => {
                alert('Reminder set!');
                modal.remove();
            });
        }

        function showCalendarModal() {
            const calendarIcon = document.getElementById('task-calendar-icon');
            const rect = calendarIcon.getBoundingClientRect();
            
            // Create the popup container
            const popup = document.createElement('div');
            popup.className = 'fixed z-50 calendar-popup';
            
            // Position directly below the calendar icon
            const top = rect.bottom + window.scrollY;
            const left = rect.left + window.scrollX;
            
            popup.style.top = `${top}px`;
            popup.style.left = `${left}px`;
            
            // Ensure popup stays within viewport
            const popupHeight = 300;
            const popupWidth = 264;
            
            if (top + popupHeight > window.innerHeight + window.scrollY) {
                popup.style.top = `${window.innerHeight + window.scrollY - popupHeight - 10}px`;
            }
            
            if (left + popupWidth > window.innerWidth + window.scrollX) {
                popup.style.left = `${window.innerWidth + window.scrollX - popupWidth - 10}px`;
            }
            
            popup.innerHTML = `
                <div class="bg-white rounded-lg shadow-lg border border-gray-200 w-64 mobile:w-auto mobile:max-w-[90vw] transform transition-all duration-200 scale-95 opacity-0"
                     style="pointer-events: auto;">
                    <div class="p-2 border-b border-gray-200 flex justify-between items-center">
                        <h3 class="text-xs font-medium text-gray-700">Schedule Task</h3>
                        <button class="text-gray-400 hover:text-gray-600 close-modal text-xs">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="p-2 space-y-2">
                        <!-- Calendar Navigation -->
                        <div class="flex justify-between items-center mb-1">
                            <button class="text-gray-500 hover:text-gray-700 prev-month p-1 rounded hover:bg-gray-100 text-xs">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <div class="font-medium text-xs month-year">June 2025</div>
                            <button class="text-gray-500 hover:text-gray-700 next-month p-1 rounded hover:bg-gray-100 text-xs">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        
                        <!-- Calendar Grid -->
                        <div class="grid grid-cols-7 gap-0.5 text-center text-2xs calendar-days mb-2">
                            <div class="py-0.5 text-gray-400 text-[10px]">S</div>
                            <div class="py-0.5 text-gray-400 text-[10px]">M</div>
                            <div class="py-0.5 text-gray-400 text-[10px]">T</div>
                            <div class="py-0.5 text-gray-400 text-[10px]">W</div>
                            <div class="py-0.5 text-gray-400 text-[10px]">T</div>
                            <div class="py-0.5 text-gray-400 text-[10px]">F</div>
                            <div class="py-0.5 text-gray-400 text-[10px]">S</div>
                        </div>
                        
                        <!-- Time Selection -->
                        <div>
                            <label class="block text-xs font-medium text-gray-700 mb-0.5">Time</label>
                            <select class="w-full border border-gray-300 rounded px-1.5 py-0.5 text-xs time-select">
                                <option value="">No time</option>
                                ${generateTimeOptions()}
                            </select>
                        </div>
                        
                        <!-- Reminder Selection -->
                        <div>
                            <label class="block text-xs font-medium text-gray-700 mb-0.5">Reminder</label>
                            <select class="w-full border border-gray-300 rounded px-1.5 py-0.5 text-xs reminder-select">
                                <option value="">No reminder</option>
                                <option value="ontheday">On the day</option>
                                <option value="1day">1 day early</option>
                                <option value="2days">2 days early</option>
                                <option value="1week">1 week early</option>
                            </select>
                        </div>
                        
                        <!-- Repeat Selection -->
                        <div>
                            <label class="block text-xs font-medium text-gray-700 mb-0.5">Repeat</label>
                            <select class="w-full border border-gray-300 rounded px-1.5 py-0.5 text-xs repeat-select">
                                <option value="">No repeat</option>
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="yearly">Yearly</option>
                                <option value="weekdays">Weekdays</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Action buttons -->
                    <div class="flex p-2 border-t border-gray-200 space-x-1">
                        <button class="flex-1 py-1 text-xs border border-gray-300 rounded text-gray-700 hover:bg-gray-50 clear-btn">Clear</button>
                        <button class="flex-1 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 ok-btn">OK</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(popup);
            
            // Animate in
            setTimeout(() => {
                const popupContent = popup.querySelector('.bg-white');
                popupContent.classList.remove('scale-95', 'opacity-0');
                popupContent.classList.add('scale-100', 'opacity-100');
            }, 10);

            // Initialize calendar with current month
            const currentDate = new Date();
            let currentMonth = currentDate.getMonth();
            let currentYear = currentDate.getFullYear();
            
            function renderCalendar(month, year) {
                const monthYearElem = popup.querySelector('.month-year');
                const calendarDaysElem = popup.querySelector('.calendar-days');
                
                // Clear existing days (keep header)
                while (calendarDaysElem.children.length > 7) {
                    calendarDaysElem.removeChild(calendarDaysElem.lastChild);
                }
                
                // Set month/year header
                const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
                                   "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
                monthYearElem.textContent = `${monthNames[month]} ${year}`;
                
                // Get first day of month and number of days
                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                
                // Add empty cells for days before first day of month
                for (let i = 0; i < firstDay; i++) {
                    const emptyCell = document.createElement('div');
                    emptyCell.className = 'py-1 text-gray-300';
                    calendarDaysElem.appendChild(emptyCell);
                }
                
                // Add days of the month
                const today = new Date();
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayCell = document.createElement('div');
                    dayCell.className = 'py-0.5 cursor-pointer hover:bg-blue-100 rounded text-[10px]';
                    
                    // Highlight today
                    if (day === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
                        dayCell.classList.add('bg-blue-100', 'font-medium');
                    }
                    
                    dayCell.textContent = day;
                    dayCell.addEventListener('click', () => {
                        // Remove selection from other days
                        popup.querySelectorAll('.calendar-days > div').forEach(cell => {
                            cell.classList.remove('bg-blue-500', 'text-white', 'font-medium');
                        });
                        // Select this day
                        dayCell.classList.add('bg-blue-500', 'text-white');
                    });
                    calendarDaysElem.appendChild(dayCell);
                }
            }
            
            function generateTimeOptions() {
                let options = '';
                const times = [
                    '09:00', '09:30', '10:00', '10:30', '11:00', '11:30',
                    '12:00', '12:30', '13:00', '13:30', '14:00', '14:30',
                    '15:00', '15:30', '16:00', '16:30', '17:00', '17:30'
                ];
                
                times.forEach(time => {
                    const [hour, minute] = time.split(':');
                    const hourNum = parseInt(hour);
                    const hour12 = hourNum % 12 || 12;
                    const ampm = hourNum < 12 ? 'AM' : 'PM';
                    const timeDisplay = `${hour12}:${minute} ${ampm}`;
                    options += `<option value="${time}">${timeDisplay}</option>`;
                });
                return options;
            }
            
            // Initial render
            renderCalendar(currentMonth, currentYear);
            
            // Month navigation
            popup.querySelector('.prev-month').addEventListener('click', () => {
                currentMonth--;
                if (currentMonth < 0) {
                    currentMonth = 11;
                    currentYear--;
                }
                renderCalendar(currentMonth, currentYear);
            });
            
            popup.querySelector('.next-month').addEventListener('click', () => {
                currentMonth++;
                if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear++;
                }
                renderCalendar(currentMonth, currentYear);
            });
            
            // Clear button
            popup.querySelector('.clear-btn').addEventListener('click', () => {
                popup.querySelectorAll('.calendar-days > div').forEach(cell => {
                    cell.classList.remove('bg-blue-500', 'text-white');
                });
                popup.querySelector('.time-select').value = '';
                popup.querySelector('.reminder-select').value = '';
                popup.querySelector('.repeat-select').value = '';
            });
            
            // OK button
            popup.querySelector('.ok-btn').addEventListener('click', () => {
                const selectedDay = popup.querySelector('.calendar-days .bg-blue-500');
                const selectedTime = popup.querySelector('.time-select').value;
                const reminder = popup.querySelector('.reminder-select').value;
                const repeat = popup.querySelector('.repeat-select').value;
                
                if (selectedDay) {
                    console.log(`Task scheduled for: ${selectedDay.textContent} ${popup.querySelector('.month-year').textContent}${selectedTime ? ' at ' + selectedTime : ''}${reminder ? ' with ' + reminder + ' reminder' : ''}${repeat ? ', repeating ' + repeat : ''}`);
                }
                
                popup.remove();
            });
            
            // Close handlers
            popup.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', () => {
                    popup.remove();
                });
            });
            
            // Close when clicking outside
            const closePopup = (e) => {
                if (!popup.contains(e.target) && e.target !== calendarIcon) {
                    popup.remove();
                    document.removeEventListener('click', closePopup);
                }
            };
            
            setTimeout(() => {
                document.addEventListener('click', closePopup);
            }, 10);
        }

        // Settings modal styles
        const settingsModalStyles = `
            .settings-modal {
                width: 600px;
                max-width: 90vw;
                height: 80vh;
                max-height: 80vh;
                background: white;
                border-radius: 12px;
                box-shadow: 0 10px 25px rgba(0,0,0,0.1);
                display: flex;
                flex-direction: column;
                overflow: hidden;
                margin: auto;
            }
            .settings-modal-container {
                display: flex;
                flex: 1;
                min-height: 0;
                overflow: hidden;
            }
            .settings-nav {
                width: 160px;
                min-width: 160px;
                background: #f8fafc;
                border-right: 1px solid #e2e8f0;
                overflow-y: auto;
                padding: 12px 0;
                scrollbar-width: thin;
            }
            .settings-nav::-webkit-scrollbar {
                width: 4px;
            }
            .settings-content {
                flex: 1;
                display: flex;
                flex-direction: column;
                overflow: hidden;
                min-width: 0;
            }
            .settings-content-inner {
                padding: 16px;
                overflow-y: auto;
                flex: 1;
                scrollbar-width: thin;
            }
            .settings-content-inner::-webkit-scrollbar {
                width: 4px;
            }
            .settings-footer {
                padding: 16px 24px;
                border-top: 1px solid #e2e8f0;
                background: white;
            }
            .settings-nav-item {
                padding: 10px 12px;
                display: flex;
                align-items: center;
                cursor: pointer;
                border-left: 3px solid transparent;
                transition: all 0.2s;
                font-size: 13px;
            }
            .settings-nav-item:hover {
                background: #f1f5f9;
            }
            .settings-nav-item.active {
                background: #f1f5f9;
                border-left-color: #3b82f6;
                color: #3b82f6;
            }
            .settings-nav-item i {
                width: 20px;
                margin-right: 12px;
                text-align: center;
            }
            .settings-section {
                margin-bottom: 24px;
            }
            .settings-section h3 {
                font-size: 18px;
                font-weight: 600;
                margin-bottom: 16px;
                color: #1e293b;
            }
            .settings-option {
                margin-bottom: 16px;
            }
            .settings-option label {
                display: block;
                font-weight: 500;
                margin-bottom: 8px;
                color: #334155;
            }
            .settings-avatar {
                width: 80px;
                height: 80px;
                border-radius: 50%;
                background: #3b82f6;
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 32px;
                font-weight: bold;
                margin: 0 auto 12px;
            }
            @media (max-width: 768px) {
                .settings-modal {
                    flex-direction: column;
                    height: 90vh;
                }
                .settings-nav {
                    width: 100%;
                    height: auto;
                    max-height: 40%;
                    border-right: none;
                    border-bottom: 1px solid #e2e8f0;
                }
            }
        `;

        function showSettingsModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl h-[85vh] flex flex-col settings-modal-container">
                    <!-- Header with close button -->
                    <div class="flex-shrink-0 px-6 py-4 border-b border-gray-200 relative">
                        <h2 class="text-xl font-semibold text-gray-800 text-center">Account Settings</h2>
                        <button class="absolute top-4 right-6 text-gray-400 hover:text-gray-600 close-settings p-1">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="flex flex-1 min-h-0">
                        <!-- Navigation Sidebar - Fixed height, no scroll -->
                        <div class="w-56 bg-gray-50 border-r border-gray-200 flex-shrink-0 overflow-hidden">
                            <nav class="h-full flex flex-col">
                                <div class="flex-1 overflow-y-auto py-4 px-2">
                                    <div class="settings-nav-item active" data-section="account">
                                        <i class="fas fa-user text-gray-500 w-5"></i>
                                        <span>Account</span>
                                    </div>
                                    <div class="settings-nav-item" data-section="premium">
                                        <i class="fas fa-crown text-gray-500 w-5"></i>
                                        <span>Premium</span>
                                    </div>
                                    <div class="settings-nav-item" data-section="features">
                                        <i class="fas fa-star text-gray-500 w-5"></i>
                                        <span>Features</span>
                                    </div>
                                    <div class="settings-nav-item" data-section="smart-list">
                                        <i class="fas fa-list text-gray-500 w-5"></i>
                                        <span>Smart List</span>
                                    </div>
                                    <div class="settings-nav-item" data-section="notifications">
                                        <i class="fas fa-bell text-gray-500 w-5"></i>
                                        <span>Notifications</span>
                                    </div>
                                    <div class="settings-nav-item" data-section="datetime">
                                        <i class="fas fa-clock text-gray-500 w-5"></i>
                                        <span>Date & Time</span>
                                    </div>
                                    <div class="settings-nav-item" data-section="appearance">
                                        <i class="fas fa-paint-brush text-gray-500 w-5"></i>
                                        <span>Appearance</span>
                                    </div>
                                    <div class="settings-nav-item" data-section="integrations">
                                        <i class="fas fa-plug text-gray-500 w-5"></i>
                                        <span>Integrations & Import</span>
                                    </div>
                                    <div class="settings-nav-item" data-section="collaborate">
                                        <i class="fas fa-users text-gray-500 w-5"></i>
                                        <span>Collaborate</span>
                                    </div>
                                    <div class="settings-nav-item" data-section="shortcuts">
                                        <i class="fas fa-keyboard text-gray-500 w-5"></i>
                                        <span>Shortcuts</span>
                                    </div>
                                    <div class="settings-nav-item" data-section="about">
                                        <i class="fas fa-info-circle text-gray-500 w-5"></i>
                                        <span>About</span>
                                    </div>
                                </div>
                            </nav>
                        </div>
                        
                        <!-- Content Area - Scrollable -->
                        <div class="flex-1 flex flex-col min-h-0">
                            <div class="flex-1 overflow-y-auto p-6">
                                <!-- Account Content -->
                                <div id="account-content" class="settings-content-section">
                                    <!-- Profile Header - Compact Layout -->
                                    <div class="flex items-start mb-6 pb-4 border-b border-gray-200">
                                        <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center mr-4 flex-shrink-0">
                                            <span class="text-white text-lg font-semibold">JD</span>
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <div class="flex items-baseline justify-between mb-1">
                                                <div class="font-semibold text-gray-900 text-base">John Doe</div>
                                                <div class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded">Free Plan</div>
                                            </div>
                                            <div class="text-sm text-gray-500">john@example.com</div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-6">
                                        <h3 class="text-sm font-medium text-gray-700 mb-3">Profile Information</h3>
                                        <div class="space-y-3">
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Name</label>
                                                <input type="text" value="John Doe" class="w-full max-w-md border border-gray-300 rounded-md px-3 py-2 text-sm">
                                            </div>
                                            <div>
                                                <label class="block text-xs text-gray-600 mb-1">Email</label>
                                                <input type="email" value="john@example.com" class="w-full max-w-md border border-gray-300 rounded-md px-3 py-2 text-sm">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-6">
                                        <h3 class="text-sm font-medium text-gray-700 mb-3">Security</h3>
                                        <div class="space-y-3">
                                            <div>
                                                <button class="px-4 py-2 bg-white border border-gray-300 rounded-md text-sm text-gray-700 hover:bg-gray-50">
                                                    Change Password
                                                </button>
                                            </div>
                                            <div>
                                                <button class="px-4 py-2 bg-white border border-gray-300 rounded-md text-sm text-gray-700 hover:bg-gray-50">
                                                    Enable Two-Factor Authentication
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-6">
                                        <h3 class="text-sm font-medium text-gray-700 mb-3">Connected Accounts</h3>
                                        <button class="px-4 py-2 bg-white border border-gray-300 rounded-md text-sm text-gray-700 hover:bg-gray-50 flex items-center">
                                            <i class="fab fa-google text-red-500 mr-2"></i>
                                            Connect Google Account
                                        </button>
                                    </div>
                                    
                                    <div>
                                        <h3 class="text-sm font-medium text-gray-700 mb-3">Account Management</h3>
                                        <button class="px-4 py-2 bg-red-50 border border-red-200 rounded-md text-sm text-red-600 hover:bg-red-100">
                                            Delete Account
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Placeholder for other sections -->
                                <div id="other-content" class="settings-content-section hidden">
                                    <div class="text-center py-8">
                                        <i class="fas fa-cog text-gray-300 text-4xl mb-3"></i>
                                        <p class="text-gray-500 text-sm">Settings content for this section will be loaded here.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal handler
            modal.querySelector('.close-settings').addEventListener('click', () => {
                modal.remove();
            });
            
            // Navigation click handlers
            modal.querySelectorAll('.settings-nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    // Update active state
                    modal.querySelectorAll('.settings-nav-item').forEach(i => {
                        i.classList.remove('active', 'bg-blue-50', 'text-blue-700');
                        i.querySelector('i').classList.remove('text-blue-600');
                        i.querySelector('i').classList.add('text-gray-500');
                    });
                    this.classList.add('active', 'bg-blue-50', 'text-blue-700');
                    this.querySelector('i').classList.remove('text-gray-500');
                    this.querySelector('i').classList.add('text-blue-600');
                    
                    // Update content based on section
                    const section = this.dataset.section;
                    const title = modal.querySelector('h2.text-xl');
                    title.textContent = `${section.charAt(0).toUpperCase() + section.slice(1).replace(/-/g, ' ')} Settings`;
                    
                    // Show appropriate content
                    if (section === 'account') {
                        modal.querySelector('#account-content').classList.remove('hidden');
                        modal.querySelector('#other-content').classList.add('hidden');
                    } else {
                        modal.querySelector('#account-content').classList.add('hidden');
                        modal.querySelector('#other-content').classList.remove('hidden');
                    }
                });
            });
            
            // Style for navigation items
            const style = document.createElement('style');
            style.textContent = `
                .settings-nav-item {
                    display: flex;
                    align-items: center;
                    padding: 10px 12px;
                    border-radius: 6px;
                    cursor: pointer;
                    transition: all 0.2s;
                    font-size: 14px;
                    color: #374151;
                    margin-bottom: 2px;
                }
                .settings-nav-item:hover {
                    background-color: #f3f4f6;
                }
                .settings-nav-item.active {
                    background-color: #eff6ff;
                    color: #1d4ed8;
                }
                .settings-nav-item i {
                    margin-right: 8px;
                    width: 20px;
                    text-align: center;
                }
                .settings-content-section {
                    transition: opacity 0.2s;
                }
            `;
            modal.appendChild(style);
            
            // Close when clicking outside
            const closeSettings = (e) => {
                if (!modal.querySelector('.settings-modal-container').contains(e.target)) {
                    modal.remove();
                    document.removeEventListener('click', closeSettings);
                }
            };
            
            setTimeout(() => {
                document.addEventListener('click', closeSettings);
            }, 10);
        }

        function showTagModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-xl w-96 max-w-full">
                    <div class="p-4 border-b border-gray-200 flex justify-between items-center">
                        <h3 class="text-lg font-medium">Select Tag</h3>
                        <button class="text-gray-500 hover:text-gray-700 close-modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="p-4 space-y-2 max-h-64 overflow-y-auto">
                        <div class="flex items-center p-2 hover:bg-gray-100 rounded cursor-pointer">
                            <i class="fas fa-circle text-red-500 text-xs mr-3"></i>
                            <span>Important</span>
                        </div>
                        <div class="flex items-center p-2 hover:bg-gray-100 rounded cursor-pointer">
                            <i class="fas fa-circle text-blue-500 text-xs mr-3"></i>
                            <span>Work</span>
                        </div>
                        <div class="flex items-center p-2 hover:bg-gray-100 rounded cursor-pointer">
                            <i class="fas fa-circle text-green-500 text-xs mr-3"></i>
                            <span>Personal</span>
                        </div>
                        <div class="flex items-center p-2 hover:bg-gray-100 rounded cursor-pointer">
                            <i class="fas fa-circle text-yellow-500 text-xs mr-3"></i>
                            <span>Shopping</span>
                        </div>
                    </div>
                    <div class="p-4 border-t border-gray-200">
                        <button class="w-full px-4 py-2 bg-blue-500 text-white rounded-md" id="add-new-tag">
                            <i class="fas fa-plus mr-2"></i> Create New Tag
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            modal.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', () => modal.remove());
            });

            modal.querySelector('#add-new-tag').addEventListener('click', () => {
                const tagName = prompt('Enter new tag name:');
                if (tagName) {
                    const color = getRandomColor();
                    const tagList = modal.querySelector('.p-4.space-y-2');
                    const newTag = document.createElement('div');
                    newTag.className = 'flex items-center p-2 hover:bg-gray-100 rounded cursor-pointer';
                    newTag.innerHTML = `
                        <i class="fas fa-circle text-${color}-500 text-xs mr-3"></i>
                        <span>${tagName}</span>
                    `;
                    tagList.appendChild(newTag);
                }
            });
        }

        // Profile popup functionality
        const profileSection = document.querySelector('.profile-section');
        const profilePopup = document.querySelector('.profile-popup');
        
        if (profileSection && profilePopup) {
            profileSection.addEventListener('click', (e) => {
                e.stopPropagation();
                const isHidden = profilePopup.classList.contains('hidden');
                
                // Hide any other open popups first
                document.querySelectorAll('.profile-popup').forEach(popup => {
                    if (popup !== profilePopup) popup.classList.add('hidden');
                });
                
                // Toggle this popup
                profilePopup.classList.toggle('hidden', !isHidden);
            });
            
            // Close when clicking outside
            document.addEventListener('click', (e) => {
                if (!profileSection.contains(e.target)) {
                    profilePopup.classList.add('hidden');
                }
            });
            
            // Handle menu item clicks
            document.querySelectorAll('.profile-menu-item').forEach(item => {
                item.addEventListener('click', () => {
                    const text = item.textContent.trim();
                    if (text === 'Settings') {
                        showSettingsModal();
                    } else {
                        alert(`${text} clicked!`); // Replace with actual functionality
                    }
                    profilePopup.classList.add('hidden');
                });
            });
        }

        // Mobile buttons
        const sidebarToggle = document.querySelector('.sidebar-toggle');
        const addTaskButton = document.querySelector('.add-task-button');
        const sidebar = document.querySelector('.sidebar');
        const sidebarOverlay = document.querySelector('.sidebar-overlay');

        if (addTaskButton) {
            addTaskButton.addEventListener('click', function() {
                const addTaskInput = document.querySelector('input[placeholder="Add a task..."]');
                if (addTaskInput) {
                    addTaskInput.focus();
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
            });
        }

        if (sidebarToggle && sidebar && sidebarOverlay) {
            sidebarToggle.addEventListener('click', () => {
                if (!document.getElementById('matrix-view').classList.contains('hidden')) return;
                sidebar.classList.add('active');
                sidebarOverlay.classList.add('active');
            });

            sidebarOverlay.addEventListener('click', () => {
                sidebar.classList.remove('active');
                sidebarOverlay.classList.remove('active');
            });
        }

        // Initialize existing tasks
        document.querySelectorAll('.task-checkbox').forEach(checkbox => {
            checkbox.onchange = function() {
                const taskItem = this.closest('.task-item');
                if (this.checked) {
                    moveToCompleted(taskItem);
                } else {
                    moveBackToOriginalSection(taskItem);
                }
            };
        });

        // Toggle task groups (including completed section)
        document.querySelectorAll('.group-toggle').forEach(toggle => {
            toggle.addEventListener('click', function() {
                const targetId = this.getAttribute('data-target');
                const targetElement = document.getElementById(targetId);
                const icon = this.querySelector('i');

                if (targetElement.classList.contains('collapsed')) {
                    targetElement.classList.remove('collapsed');
                    icon.classList.remove('fa-chevron-right');
                    icon.classList.add('fa-chevron-down');
                } else {
                    targetElement.classList.add('collapsed');
                    icon.classList.remove('fa-chevron-down');
                    icon.classList.add('fa-chevron-right');
                }
            });
        });

        // Add priority to tasks
        document.querySelectorAll('.fa-flag').forEach(flag => {
            flag.addEventListener('click', function(e) {
                e.stopPropagation();
                if (this.classList.contains('text-red-500')) {
                    this.classList.remove('text-red-500');
                    this.classList.add('text-gray-300');
                } else {
                    this.classList.remove('text-gray-300');
                    this.classList.add('text-red-500');
                }
            });
        });

        // Task data storage
        const tasks = {
            inbox: [],
            today: [],
            week: [],
            projects: {},
            tags: {},
            completed: []
        };

        // Initialize existing tasks in data store
        document.querySelectorAll('.task-item').forEach(task => {
            const taskId = task.getAttribute('data-id');
            const taskText = task.querySelector('.task-text').textContent;
            const taskDate = task.querySelector('.far.fa-calendar')?.nextElementSibling?.textContent || 'Today';
            const taskTag = task.querySelector('.fa-tag')?.nextElementSibling?.textContent || 'Work';
            
            tasks.today.push({
                id: taskId,
                text: taskText,
                date: taskDate,
                tag: taskTag,
                completed: false
            });
        });

        // Add task functionality
        const newTaskInput = document.getElementById('new-task-input');
        const addTaskBtn = document.getElementById('add-task-btn');

        if (newTaskInput && addTaskBtn) {
            newTaskInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addTaskBtn.click();
                }
            });

            addTaskBtn.addEventListener('click', function() {
                const taskText = newTaskInput.value.trim();
                if (taskText !== '') {
                    const todayTasks = document.getElementById('today-tasks');
                    const taskId = 'task-' + Date.now();
                    
                    const newTask = document.createElement('div');
                    newTask.className = 'task-item p-2 border-b border-gray-200 flex items-center hover:bg-gray-50 fade-in';
                    newTask.setAttribute('data-id', taskId);
                    newTask.innerHTML = `
                        <input type="checkbox" class="task-checkbox custom-checkbox">
                        <div class="ml-2 flex-1">
                            <div class="task-text text-gray-800">${taskText}</div>
                            <div class="flex items-center text-xs text-gray-500">
                                <div class="flex items-center">
                                    <i class="far fa-calendar mr-1"></i>
                                    <span>Today</span>
                                </div>
                                <div class="ml-4 flex items-center">
                                    <i class="fas fa-tag mr-1 text-blue-500"></i>
                                    <span>Work</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2 text-gray-400 relative">
                            <i class="fas fa-flag text-gray-300 cursor-pointer hover:text-red-500"></i>
                            <i class="far fa-comment cursor-pointer hover:text-yellow-500"></i>
                            <i class="fas fa-ellipsis-h cursor-pointer hover:text-gray-600"></i>
                            <!-- Task actions menu will be inserted here -->
                        </div>
                    `;

                    // Add to the top of today's tasks
                    todayTasks.insertBefore(newTask, todayTasks.firstChild);
                    
                    // Add to data store
                    const newTaskObj = {
                        id: taskId,
                        text: taskText,
                        date: 'Today',
                        tag: 'Work',
                        completed: false
                    };
                    tasks.today.push(newTaskObj);
                    tasks.inbox.push(newTaskObj);

                    // Clear input
                    newTaskInput.value = '';

                    // Update task count
                    updateTaskCount('today-tasks');

                    // Add event listeners to new task
                    const checkbox = newTask.querySelector('.task-checkbox');
                    checkbox.addEventListener('change', function() {
                        const taskItem = this.closest('.task-item');
                        if (this.checked) {
                            moveToCompleted(taskItem);
                        } else {
                            moveBackToOriginalSection(taskItem);
                        }
                    });

                    const flag = newTask.querySelector('.fa-flag');
                    flag.addEventListener('click', function(e) {
                        e.stopPropagation();
                        if (this.classList.contains('text-red-500')) {
                            this.classList.remove('text-red-500');
                            this.classList.add('text-gray-300');
                        } else {
                            this.classList.remove('text-gray-300');
                            this.classList.add('text-red-500');
                        }
                    });
                }
            });
        }

        function updateTaskCount(sectionId) {
            const section = document.getElementById(sectionId);
            const count = section.children.length;
            const countElement = document.querySelector(`.task-count[data-target="${sectionId}"]`);
            
            if (countElement) {
                countElement.textContent = `${count} task${count !== 1 ? 's' : ''}`;
            }
        }

        function moveToCompleted(taskElement) {
            const completedTasks = document.getElementById('completed-tasks');
            const taskId = taskElement.getAttribute('data-id');
            
            // Store original section reference and position
            const originalSection = taskElement.parentElement;
            taskElement.dataset.originalSection = originalSection.id;
            
            // Store all siblings before moving
            const siblings = Array.from(originalSection.children);
            const taskIndex = siblings.indexOf(taskElement);
            taskElement.dataset.originalPosition = taskIndex;
            
            // Add completed styling
            taskElement.classList.add('completed-task');
            const taskText = taskElement.querySelector('.task-text');
            if (taskText) {
                taskText.classList.add('line-through', 'text-gray-400');
            }
            
            // Move task to completed section
            completedTasks.appendChild(taskElement);
            
            // Update data store
            const taskIndexToday = tasks.today.findIndex(task => task.id === taskId);
            if (taskIndexToday !== -1) {
                tasks.today[taskIndexToday].completed = true;
                tasks.completed.push(tasks.today[taskIndexToday]);
            }
            
            // Update task counts
            updateTaskCount(originalSection.id);
            updateTaskCount('completed-tasks');
            
            // Make sure completed section is expanded
            const completedHeader = document.querySelector('[data-target="completed-tasks"]');
            if (completedHeader) {
                const icon = completedHeader.querySelector('i');
                if (icon) {
                    icon.classList.remove('fa-chevron-right');
                    icon.classList.add('fa-chevron-down');
                }
                completedTasks.classList.remove('collapsed');
                completedTasks.style.maxHeight = completedTasks.scrollHeight + 'px';
            }
        }

        function moveBackToOriginalSection(taskElement) {
            const originalSectionId = taskElement.dataset.originalSection;
            const originalPosition = parseInt(taskElement.dataset.originalPosition);
            const originalSection = document.getElementById(originalSectionId);
            const taskId = taskElement.getAttribute('data-id');
            
            if (!originalSection) return;
            
            // Remove completed styling
            taskElement.classList.remove('completed-task');
            const taskText = taskElement.querySelector('.task-text');
            if (taskText) {
                taskText.classList.remove('line-through', 'text-gray-400');
            }
            
            // Insert back at original position
            const currentTasks = Array.from(originalSection.children);
            if (originalPosition < currentTasks.length) {
                originalSection.insertBefore(taskElement, currentTasks[originalPosition]);
            } else {
                originalSection.appendChild(taskElement);
            }
            
            // Update data store
            const taskIndexCompleted = tasks.completed.findIndex(task => task.id === taskId);
            if (taskIndexCompleted !== -1) {
                tasks.completed.splice(taskIndexCompleted, 1);
                
                // Update in today's tasks
                const taskIndexToday = tasks.today.findIndex(task => task.id === taskId);
                if (taskIndexToday !== -1) {
                    tasks.today[taskIndexToday].completed = false;
                }
            }
            
            // Update task counts
            updateTaskCount(originalSectionId);
            updateTaskCount('completed-tasks');
            
            // Make sure original section is expanded
            const originalHeader = document.querySelector(`[data-target="${originalSectionId}"]`);
            if (originalHeader) {
                const icon = originalHeader.querySelector('i');
                if (icon) {
                    icon.classList.remove('fa-chevron-right');
                    icon.classList.add('fa-chevron-down');
                }
                originalSection.classList.remove('collapsed');
                originalSection.style.maxHeight = originalSection.scrollHeight + 'px';
            }
        }

        // Initialize task counts
        function initializeTaskCounts() {
            updateTaskCount('overdue-tasks');
            updateTaskCount('today-tasks');
            updateTaskCount('completed-tasks');
            
            // Make sure completed section is expanded by default if it has tasks
            const completedTasks = document.getElementById('completed-tasks');
            if (completedTasks) {
                if (completedTasks.children.length > 0) {
                    const completedHeader = document.querySelector('[data-target="completed-tasks"]');
                    if (completedHeader) {
                        const icon = completedHeader.querySelector('i');
                        if (icon) {
                            icon.classList.remove('fa-chevron-right');
                            icon.classList.add('fa-chevron-down');
                        }
                        completedTasks.classList.remove('collapsed');
                        completedTasks.style.maxHeight = completedTasks.scrollHeight + 'px';
                    }
                } else {
                    // If no tasks, collapse the section
                    const completedHeader = document.querySelector('[data-target="completed-tasks"]');
                    if (completedHeader) {
                        const icon = completedHeader.querySelector('i');
                        if (icon) {
                            icon.classList.remove('fa-chevron-down');
                            icon.classList.add('fa-chevron-right');
                        }
                        completedTasks.classList.add('collapsed');
                        completedTasks.style.maxHeight = '0';
                    }
                }
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeTaskCounts();
            
            // Set initial collapsed state for sections
            document.querySelectorAll('.collapsible-content').forEach(section => {
                section.style.maxHeight = section.scrollHeight + 'px';
            });

            // Projects and Tags dropdown functionality
            document.querySelectorAll('.project-header, .tag-header').forEach(header => {
                header.addEventListener('click', function(e) {
                    // Don't toggle if clicking the plus icon
                    if (e.target.classList.contains('fa-plus')) return;
                    
                    const content = this.nextElementSibling;
                    content.classList.toggle('hidden');
                });
            });

            // Plus icon click handlers
            document.querySelector('.project-header .fa-plus').addEventListener('click', function(e) {
                e.stopPropagation();
                const projectName = prompt('Enter project name:');
                if (projectName) {
                    const projectsList = document.querySelector('.project-content');
                    const newProject = document.createElement('div');
                    newProject.className = 'sidebar-item px-2 py-2 flex items-center text-gray-700 cursor-pointer';
                    newProject.dataset.project = projectName.toLowerCase().replace(/\s+/g, '-');
                    newProject.innerHTML = `
                        <div class="w-3 h-3 rounded-full bg-${getRandomColor()}-500"></div>
                        <span class="ml-3">${projectName}</span>
                    `;
                    projectsList.appendChild(newProject);
                }
            });

            document.querySelector('.tag-header .fa-plus').addEventListener('click', function(e) {
                e.stopPropagation();
                const tagName = prompt('Enter tag name:');
                if (tagName) {
                    const tagsList = document.querySelector('.tag-content');
                    const newTag = document.createElement('div');
                    newTag.className = 'sidebar-item px-2 py-2 flex items-center text-gray-700 cursor-pointer';
                    newTag.dataset.tag = tagName.toLowerCase().replace(/\s+/g, '-');
                    newTag.innerHTML = `
                        <i class="fas fa-circle text-${getRandomColor()}-500 text-xs"></i>
                        <span class="ml-3">${tagName}</span>
                    `;
                    tagsList.appendChild(newTag);
                }
            });
        });

        // Sidebar navigation
        document.querySelectorAll('.sidebar-item').forEach(item => {
            item.addEventListener('click', function() {
                // Remove active class from all items
                document.querySelectorAll('.sidebar-item').forEach(i => {
                    i.classList.remove('text-blue-600', 'bg-blue-50');
                    i.querySelector('i')?.classList?.remove('text-blue-500');
                    i.querySelector('i')?.classList?.add('text-gray-500');
                });

                // Add active class to clicked item
                this.classList.add('text-blue-600', 'bg-blue-50');
                this.querySelector('i')?.classList?.remove('text-gray-500');
                this.querySelector('i')?.classList?.add('text-blue-500');

                // Update view based on data-view attribute or context
                const view = this.getAttribute('data-view');
                const project = this.getAttribute('data-project');
                const tag = this.getAttribute('data-tag');
                const header = document.querySelector('h1.text-xl');
                const dateDisplay = document.querySelector('.ml-4.text-sm.text-gray-500');

                if (view) {
                    switch(view) {
                        case 'inbox':
                            header.textContent = 'Inbox';
                            dateDisplay.textContent = 'All Tasks';
                            filterTasks('inbox');
                            break;
                        case 'today':
                            header.textContent = 'Today';
                            dateDisplay.textContent = new Date().toLocaleDateString('en-US', { 
                                weekday: 'short', 
                                month: 'short', 
                                day: 'numeric' 
                            });
                            filterTasks('today');
                            break;
                        case 'week':
                            header.textContent = 'Next 7 Days';
                            const nextWeek = new Date();
                            nextWeek.setDate(nextWeek.getDate() + 7);
                            dateDisplay.textContent = `${new Date().toLocaleDateString()} - ${nextWeek.toLocaleDateString()}`;
                            filterTasks('week');
                            break;
                    }
                } else if (project) {
                    header.textContent = project.charAt(0).toUpperCase() + project.slice(1).replace('-', ' ');
                    dateDisplay.textContent = 'Project';
                    filterTasks('project', project);
                } else if (tag) {
                    header.textContent = tag.charAt(0).toUpperCase() + tag.slice(1).replace('-', ' ');
                    dateDisplay.textContent = 'Tag';
                    filterTasks('tag', tag);
                }
            });
        });

        function filterTasks(filter, projectOrTag = null) {
            const overdueSection = document.getElementById('overdue-tasks');
            const todaySection = document.getElementById('today-tasks');
            const completedSection = document.getElementById('completed-tasks');

            // Hide all tasks first
            document.querySelectorAll('.task-item').forEach(task => {
                task.style.display = 'none';
            });

            switch(filter) {
                case 'inbox':
                    // Show all tasks except completed
                    overdueSection.style.display = 'block';
                    todaySection.style.display = 'block';
                    document.querySelectorAll('#overdue-tasks .task-item, #today-tasks .task-item').forEach(task => {
                        task.style.display = 'flex';
                    });
                    break;
                                
                case 'today':
                    // Show only today's tasks
                    overdueSection.style.display = 'none';
                    todaySection.style.display = 'block';
                    document.querySelectorAll('#today-tasks .task-item').forEach(task => {
                        task.style.display = 'flex';
                    });
                    break;
                                
                case 'week':
                    // Show tasks for next 7 days (in this demo, same as inbox)
                    overdueSection.style.display = 'block';
                    todaySection.style.display = 'block';
                    document.querySelectorAll('#overdue-tasks .task-item, #today-tasks .task-item').forEach(task => {
                        task.style.display = 'flex';
                    });
                    break;
                                
                case 'project':
                    // Filter by project
                    overdueSection.style.display = 'none';
                    todaySection.style.display = 'block';
                    document.querySelectorAll('.task-item').forEach(task => {
                        const project = task.querySelector('.fa-tag')?.nextElementSibling?.textContent.toLowerCase();
                        if (project === projectOrTag) {
                            task.style.display = 'flex';
                        }
                    });
                    break;
                                
                case 'tag':
                    // Filter by tag
                    overdueSection.style.display = 'none';
                    todaySection.style.display = 'block';
                    document.querySelectorAll('.task-item').forEach(task => {
                        const tag = task.querySelector('.fa-tag')?.nextElementSibling?.textContent.toLowerCase();
                        if (tag === projectOrTag) {
                            task.style.display = 'flex';
                        }
                    });
                    break;
            }

            // Show/hide completed tasks section based on filter
            if (filter === 'tag') {
                completedSection.style.display = 'block';
                // Show only completed tasks with matching tag
                document.querySelectorAll('.completed-tasks .task-item').forEach(task => {
                    const taskTag = task.querySelector('.fa-tag')?.nextElementSibling?.textContent.toLowerCase();
                    task.style.display = taskTag === projectOrTag ? 'flex' : 'none';
                });
            } else {
                completedSection.style.display = 'block';
                document.querySelectorAll('.completed-tasks .task-item').forEach(task => {
                    task.style.display = 'flex';
                });
            }
        }

        // Bottom navigation
        document.querySelectorAll('[data-tab]').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabName = this.getAttribute('data-tab');
                
                // Remove active class from all tabs
                document.querySelectorAll('[data-tab]').forEach(t => {
                    t.querySelector('div').classList.remove('text-blue-500');
                    t.querySelector('span').classList.remove('text-blue-500');
                    t.querySelector('div').classList.add('text-gray-500', 'dark:text-gray-400');
                    t.querySelector('span').classList.add('text-gray-500', 'dark:text-gray-400');
                });

                // Add active class to clicked tab
                this.querySelector('div').classList.remove('text-gray-500', 'dark:text-gray-400');
                this.querySelector('span').classList.remove('text-gray-500', 'dark:text-gray-400');
                this.querySelector('div').classList.add('text-blue-500');
                this.querySelector('span').classList.add('text-blue-500');

                // Hide all views first
                document.querySelectorAll('.flex-1.flex.flex-col > div').forEach(view => {
                    view.classList.add('hidden');
                });

                // Show the appropriate view
                if (tabName === 'tasks') {
                    document.querySelector('.flex-1.flex.flex-col > div:not(#matrix-view)').classList.remove('hidden');
                    document.querySelector('.sidebar').classList.remove('hidden');
                    document.querySelector('.flex-1.flex.flex-col').classList.remove('ml-0');
                } else if (tabName === 'matrix') {
                    document.getElementById('matrix-view').classList.remove('hidden');
                    document.querySelector('.sidebar').classList.add('hidden');
                    document.querySelector('.flex-1.flex.flex-col').classList.add('ml-0');
                    // Load tasks into matrix view
                    loadMatrixTasks();
                } else {
                    console.log('Switched to tab:', tabName);
                    document.querySelector('.sidebar').classList.add('hidden');
                    document.querySelector('.flex-1.flex.flex-col').classList.add('ml-0');
                }
            });
        });

        function loadMatrixTasks() {
            // In a real app, this would load tasks from your data store
            // and categorize them into the 4 quadrants
            
            // Example of how to add a task to a quadrant
            const addTaskToQuadrant = (quadrantId, task) => {
                const quadrant = document.querySelector(`.task-list[data-category="${quadrantId}"]`);
                const noTasksMsg = quadrant.querySelector('.text-center');
                
                if (noTasksMsg) {
                    quadrant.innerHTML = '';
                }
                
                const taskElement = document.createElement('div');
                taskElement.className = 'task-item p-2 border-b border-gray-200 flex items-center hover:bg-gray-50';
                taskElement.innerHTML = `
                    <input type="checkbox" class="task-checkbox custom-checkbox">
                    <div class="ml-2 flex-1">
                        <div class="task-text text-gray-800">${task.text}</div>
                        <div class="flex items-center text-xs text-gray-500">
                            <div class="flex items-center">
                                <i class="far fa-calendar mr-1"></i>
                                <span>${task.date}</span>
                            </div>
                            <div class="ml-4 flex items-center">
                                <i class="fas fa-tag mr-1 text-${task.tagColor}-500"></i>
                                <span>${task.tag}</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2 text-gray-400">
                        <i class="fas fa-flag text-${task.priorityColor}-500 cursor-pointer"></i>
                        <i class="far fa-comment cursor-pointer hover:text-yellow-500"></i>
                        <i class="fas fa-ellipsis-h cursor-pointer hover:text-gray-600"></i>
                    </div>
                `;
                quadrant.appendChild(taskElement);
            };
            
            // Example tasks (replace with your actual task data)
            const exampleTasks = [
                {
                    id: 'task-101',
                    text: 'Fix critical bug in production',
                    date: 'Today',
                    tag: 'Work',
                    tagColor: 'red',
                    priorityColor: 'red',
                    quadrant: 'urgent-important'
                },
                {
                    id: 'task-102',
                    text: 'Plan next quarter strategy',
                    date: 'Next Week',
                    tag: 'Work',
                    tagColor: 'blue',
                    priorityColor: 'yellow',
                    quadrant: 'not-urgent-important'
                },
                {
                    id: 'task-103',
                    text: 'Respond to client email',
                    date: 'Today',
                    tag: 'Work',
                    tagColor: 'blue',
                    priorityColor: 'blue',
                    quadrant: 'urgent-unimportant'
                },
                {
                    id: 'task-104',
                    text: 'Organize desk',
                    date: 'Someday',
                    tag: 'Personal',
                    tagColor: 'green',
                    priorityColor: 'green',
                    quadrant: 'not-urgent-unimportant'
                }
            ];
            
            // Add example tasks to their quadrants
            exampleTasks.forEach(task => {
                addTaskToQuadrant(task.quadrant, task);
            });
        }

        // Initialize with Tasks tab active
        document.querySelector('[data-tab="tasks"]').querySelector('div').classList.remove('text-gray-500', 'dark:text-gray-400');
        document.querySelector('[data-tab="tasks"]').querySelector('span').classList.remove('text-gray-500', 'dark:text-gray-400');

        // Theme toggle functionality
        document.querySelector('.theme-toggle').addEventListener('click', function() {
            const isDarkMode = document.body.classList.toggle('dark-mode');
            const themeIcon = this.querySelector('i');
            
            // Toggle between moon and sun icons
            if (isDarkMode) {
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
                themeIcon.classList.add('text-yellow-400');
            } else {
                themeIcon.classList.remove('fa-sun', 'text-yellow-400');
                themeIcon.classList.add('fa-moon');
            }
            
            // Save preference to localStorage
            localStorage.setItem('darkMode', isDarkMode);
        });

        // Check for saved dark mode preference
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
            const themeIcon = document.querySelector('.theme-toggle i');
            if (themeIcon) {
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun', 'text-yellow-400');
            }
        }

        // Add dark mode styles
        const darkModeStyles = `
            .dark-mode {
                background-color: #111827 !important;
                color: #e5e7eb;
            }
            
            .dark-mode .bg-white {
                background-color: #1f2937 !important;
                border-color: #374151 !important;
            }
            
            .dark-mode .text-gray-800,
            .dark-mode .text-gray-700,
            .dark-mode .text-gray-600 {
                color: #e5e7eb !important;
            }
            
            .dark-mode .text-gray-500,
            .dark-mode .text-gray-400 {
                color: #9ca3af !important;
            }
            
            .dark-mode .border-gray-200 {
                border-color: #374151 !important;
            }
            
            .dark-mode .bg-gray-100 {
                background-color: #374151 !important;
            }
            
            .dark-mode .bg-gray-50 {
                background-color: #1f2937 !important;
            }
            
            .dark-mode .hover\:bg-gray-100:hover {
                background-color: #374151 !important;
            }
            
            .dark-mode .task-item:hover {
                background-color: #374151 !important;
            }
            
            .dark-mode .sidebar-item:hover {
                background-color: rgba(59, 130, 246, 0.2) !important;
            }
            
            .dark-mode .bg-blue-50 {
                background-color: rgba(59, 130, 246, 0.1) !important;
            }
            
            .dark-mode input,
            .dark-mode select {
                background-color: transparent !important;
                border-color: #4b5563 !important;
                color: #e5e7eb !important;
            }
            .dark-mode #new-task-input {
                border-bottom-color: #4b5563 !important;
            }
            .dark-mode #new-task-input:focus {
                border-bottom-color: #3b82f6 !important;
            }
            
            .dark-mode input::placeholder {
                color: #9ca3af !important;
            }
            
            .dark-mode .shadow-sm {
                box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.3) !important;
            }
            
            .dark-mode .completed-task {
                background-color: #1a2231 !important;
            }
            
            .dark-mode .custom-checkbox {
                border-color: #4b5563 !important;
                background-color: #374151 !important;
            }
            
            .dark-mode .custom-checkbox:checked {
                background-color: #3b82f6 !important;
                border-color: #3b82f6 !important;
            }
            
            .dark-mode .fa-search {
                color: #9ca3af !important;
            }
            
            .dark-mode .task-checkbox:checked + .task-text {
                color: #6b7280 !important;
            }
            
            /* Scrollbar styling for dark mode */
            .dark-mode ::-webkit-scrollbar-track {
                background: #1f2937 !important;
            }
            
            .dark-mode ::-webkit-scrollbar-thumb {
                background: #4b5563 !important;
            }
            
            .dark-mode ::-webkit-scrollbar-thumb:hover {
                background: #6b7280 !important;
            }
            
            /* Calendar popup dark mode */
            .dark-mode .calendar-popup .bg-white {
                background-color: #1f2937 !important;
                border-color: #374151 !important;
            }
            
            /* Settings modal dark mode */
            .dark-mode .settings-nav {
                background-color: #111827 !important;
                border-color: #374151 !important;
            }
            
            .dark-mode .settings-nav-item {
                color: #e5e7eb !important;
            }
            
            .dark-mode .settings-nav-item:hover {
                background-color: #374151 !important;
            }
            
            .dark-mode .settings-nav-item.active {
                background-color: #374151 !important;
                color: #3b82f6 !important;
            }
        `;

        // Add dark mode styles to document
        const styleElement = document.createElement('style');
        styleElement.textContent = darkModeStyles;
        document.head.appendChild(styleElement);

        // Settings button
        document.querySelector('.fa-cog').addEventListener('click', function() {
            alert('Settings would open here');
        });

        // Projects functionality
        document.querySelectorAll('.projects-section .fa-plus').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const projectName = prompt('Enter project name:');
                if (projectName) {
                    const projectsList = this.closest('.projects-section').querySelector('.pl-10.pr-4.py-1');
                    const newProject = document.createElement('div');
                    newProject.className = 'sidebar-item px-2 py-2 flex items-center text-gray-700 cursor-pointer';
                    newProject.dataset.project = projectName.toLowerCase().replace(/\s+/g, '-');
                    newProject.innerHTML = `
                        <div class="w-3 h-3 rounded-full bg-${getRandomColor()}-500"></div>
                        <span class="ml-3">${projectName}</span>
                    `;
                    projectsList.appendChild(newProject);

                    // Add click handler to filter tasks by project
                    newProject.addEventListener('click', function() {
                        filterTasksByProject(this.dataset.project);
                    });
                }
            });
        });

        function filterTasksByProject(project) {
            console.log(`Filtering tasks for project: ${project}`);
            // In a real app, this would filter tasks from your data store
            document.querySelector('h1.text-xl').textContent = project.charAt(0).toUpperCase() + project.slice(1).replace('-', ' ');
        }

        // Tags functionality
        document.querySelectorAll('.tags-section .fa-plus').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const tagName = prompt('Enter tag name:');
                if (tagName) {
                    const tagsList = this.closest('.tags-section').querySelector('.pl-10.pr-4.py-1');
                    const newTag = document.createElement('div');
                    newTag.className = 'sidebar-item px-2 py-2 flex items-center text-gray-700 cursor-pointer';
                    newTag.dataset.tag = tagName.toLowerCase().replace(/\s+/g, '-');
                    newTag.innerHTML = `
                        <i class="fas fa-circle text-${getRandomColor()}-500 text-xs"></i>
                        <span class="ml-3">${tagName}</span>
                    `;
                    tagsList.appendChild(newTag);

                    // Add click handler to filter tasks by tag
                    newTag.addEventListener('click', function() {
                        // Remove active class from all tags
                        document.querySelectorAll('.tags-section .sidebar-item').forEach(tag => {
                            tag.classList.remove('active-tag');
                        });

                        // Add active class to clicked tag
                        this.classList.add('active-tag');

                        // Filter tasks
                        filterTasks('tag', this.dataset.tag);
                    });
                }
            });
        });

        // Initialize existing tag click handlers
        document.querySelectorAll('.tags-section .sidebar-item').forEach(tag => {
            tag.addEventListener('click', function() {
                // Remove active class from all tags
                document.querySelectorAll('.tags-section .sidebar-item').forEach(t => {
                    t.classList.remove('active-tag');
                });

                // Add active class to clicked tag
                this.classList.add('active-tag');

                // Filter tasks
                filterTasks('tag', this.dataset.tag);
            });
        });

        // Settings functionality
        document.querySelector('.settings-section .sidebar-item').addEventListener('click', function() {
            // Create settings modal
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-xl w-96 max-w-full">
                    <div class="p-4 border-b border-gray-200 flex justify-between items-center">
                        <h3 class="text-lg font-medium">Settings</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="close-settings">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="p-4 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Theme</label>
                            <select class="w-full border border-gray-300 rounded-md p-2">
                                <option>Light</option>
                                <option>Dark</option>
                                <option>System</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Default Due Date</label>
                            <select class="w-full border border-gray-300 rounded-md p-2">
                                <option>None</option>
                                <option>Today</option>
                                <option>Tomorrow</option>
                                <option>Next Week</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Default Priority</label>
                            <select class="w-full border border-gray-300 rounded-md p-2">
                                <option>None</option>
                                <option>Low</option>
                                <option>Medium</option>
                                <option>High</option>
                            </select>
                        </div>
                    </div>
                    <div class="p-4 border-t border-gray-200 flex justify-end space-x-2">
                        <button class="px-4 py-2 border border-gray-300 rounded-md">Cancel</button>
                        <button class="px-4 py-2 bg-blue-500 text-white rounded-md">Save</button>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);

            // Close modal handler
            modal.querySelector('#close-settings').addEventListener('click', () => {
                modal.remove();
            });

            // Save handler
            modal.querySelector('button.bg-blue-500').addEventListener('click', () => {
                alert('Settings saved!');
                modal.remove();
            });
        });

        function getRandomColor() {
            const colors = ['red', 'blue', 'green', 'yellow', 'purple', 'pink', 'indigo'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // Add button event listeners
        document.getElementById('remind-me-btn')?.addEventListener('click', showReminderModal);
        document.getElementById('due-date-btn')?.addEventListener('click', showDueDateModal);
        document.getElementById('tag-btn')?.addEventListener('click', showTagModal);
        
        // Calendar icon click handler - use specific ID for the task input calendar
        document.getElementById('task-calendar-icon')?.addEventListener('click', showCalendarModal);
        document.querySelector('.fa-calendar:not(#task-calendar-icon)')?.addEventListener('click', showCalendarModal);
    </script>

    <!-- Task Actions Dropdown Menu Template -->
    <div id="task-actions-menu-template" style="display: none;">
        <div class="task-actions-menu">
            <div class="task-actions-menu-item date-item">
                <i class="far fa-calendar"></i>
                <span>Date</span>
                <div class="date-shortcuts">
                    <span class="date-shortcut" data-days="0">Today</span>
                    <span class="date-shortcut" data-days="1">Tomorrow</span>
                    <span class="date-shortcut" data-days="7">Next Week</span>
                </div>
            </div>
            
            <div class="task-actions-menu-item priority-item">
                <i class="far fa-flag"></i>
                <span>Priority</span>
                <div class="priority-options">
                    <span class="priority-option" data-priority="1"><div class="flag-icon red"></div></span>
                    <span class="priority-option" data-priority="2"><div class="flag-icon blue"></div></span>
                    <span class="priority-option" data-priority="3"><div class="flag-icon yellow"></div></span>
                </div>
            </div>
            
            <div class="task-actions-menu-item">
                <i class="fas fa-tasks"></i>
                <span>Add Subtask</span>
            </div>
            
            <div class="task-actions-menu-item">
                <i class="fas fa-thumbtack"></i>
                <span>Pin</span>
            </div>
            
            <div class="task-actions-menu-item">
                <i class="fas fa-ban"></i>
                <span>Won't Do</span>
            </div>
            
            <div class="task-actions-menu-item has-submenu">
                <i class="fas fa-arrow-right"></i>
                <span>Move To</span>
                <i class="fas fa-chevron-right chevron"></i>
                <div class="task-actions-menu-submenu">
                    <div class="task-actions-menu-item" data-target="inbox">Inbox</div>
                    <div class="task-actions-menu-item" data-target="today">Today</div>
                    <div class="task-actions-menu-item" data-target="week">Next 7 Days</div>
                    <hr>
                    <div class="task-actions-menu-item" data-target="project-work">Work</div>
                    <div class="task-actions-menu-item" data-target="project-personal">Personal</div>
                    <div class="task-actions-menu-item" data-target="project-shopping">Shopping</div>
                </div>
            </div>
            
            <div class="task-actions-menu-item">
                <i class="fas fa-tag"></i>
                <span>Tags</span>
            </div>
            
            <div class="task-actions-menu-item">
                <i class="far fa-copy"></i>
                <span>Duplicate</span>
            </div>
            
            <div class="task-actions-menu-item">
                <i class="fas fa-link"></i>
                <span>Copy Link</span>
            </div>
            
            <div class="task-actions-menu-item">
                <i class="far fa-sticky-note"></i>
                <span>Convert to Note</span>
            </div>
            
            <hr>
            
            <div class="task-actions-menu-item delete-item">
                <i class="far fa-trash-alt"></i>
                <span>Delete</span>
            </div>
        </div>
    </div>

    <script>
        // Task action menu functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Add click handler for all three-dot buttons
            document.addEventListener('click', function(e) {
                const ellipsisBtn = e.target.closest('.fa-ellipsis-h');
                if (ellipsisBtn) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Close any open menus first
                    document.querySelectorAll('.task-actions-menu').forEach(menu => {
                        menu.classList.remove('active');
                    });
                    
                    // Get the task item
                    const taskItem = ellipsisBtn.closest('.task-item');
                    const taskId = taskItem.dataset.id;
                    
                    // Create or clone the menu
                    let menu = taskItem.querySelector('.task-actions-menu');
                    if (!menu) {
                        const template = document.getElementById('task-actions-menu-template');
                        menu = template.querySelector('.task-actions-menu').cloneNode(true);
                        taskItem.appendChild(menu);
                        
                        // Position the menu
                        const ellipsisRect = ellipsisBtn.getBoundingClientRect();
                        menu.style.right = '0';
                        menu.style.top = `${ellipsisRect.bottom - ellipsisRect.top + 4}px`;
                        
                        // Add click handlers for menu items
                        menu.querySelectorAll('.task-actions-menu-item').forEach(item => {
                            if (!item.classList.contains('has-submenu')) {
                                item.addEventListener('click', function() {
                                    handleMenuItemClick(this, taskId);
                                    menu.classList.remove('active');
                                });
                            }
                        });
                        
                        // Add date shortcut handlers
                        menu.querySelectorAll('.date-shortcut').forEach(shortcut => {
                            shortcut.addEventListener('click', function(e) {
                                e.stopPropagation();
                                const days = parseInt(this.dataset.days);
                                setTaskDate(taskId, days);
                                menu.classList.remove('active');
                            });
                        });
                        
                        // Add priority handlers
                        menu.querySelectorAll('.priority-option').forEach(option => {
                            option.addEventListener('click', function(e) {
                                e.stopPropagation();
                                const priority = parseInt(this.dataset.priority);
                                setTaskPriority(taskId, priority);
                                menu.classList.remove('active');
                            });
                        });
                    }
                    
                    // Show the menu
                    menu.classList.add('active');
                    
                    // Close when clicking outside
                    setTimeout(() => {
                        const closeMenu = function(e) {
                            if (!menu.contains(e.target) && e.target !== ellipsisBtn) {
                                menu.classList.remove('active');
                                document.removeEventListener('click', closeMenu);
                            }
                        };
                        document.addEventListener('click', closeMenu);
                    }, 10);
                }
            });
            
            function handleMenuItemClick(item, taskId) {
                const action = item.textContent.trim();
                console.log(`Action "${action}" clicked for task ${taskId}`);
                
                // Handle different actions
                if (action === 'Delete') {
                    if (confirm('Are you sure you want to delete this task?')) {
                        deleteTask(taskId);
                    }
                } else if (action === 'Duplicate') {
                    duplicateTask(taskId);
                } else if (action === 'Add Subtask') {
                    addSubtask(taskId);
                } else if (action === 'Pin') {
                    togglePinTask(taskId);
                } else if (action === 'Won\'t Do') {
                    markWontDo(taskId);
                } else if (action === 'Tags') {
                    showTagModal(taskId);
                } else if (action === 'Copy Link') {
                    copyTaskLink(taskId);
                } else if (action === 'Convert to Note') {
                    convertToNote(taskId);
                }
            }
            
            function setTaskDate(taskId, daysFromToday) {
                const date = new Date();
                date.setDate(date.getDate() + daysFromToday);
                console.log(`Setting date for task ${taskId} to ${date.toDateString()}`);
                // Update task in UI and data store
            }
            
            function setTaskPriority(taskId, priority) {
                console.log(`Setting priority ${priority} for task ${taskId}`);
                // Update task in UI and data store
            }
            
            function deleteTask(taskId) {
                console.log(`Deleting task ${taskId}`);
                // Remove from UI and data store
                document.querySelector(`.task-item[data-id="${taskId}"]`).remove();
            }
            
            function duplicateTask(taskId) {
                console.log(`Duplicating task ${taskId}`);
                // Create copy in UI and data store
            }
            
            function addSubtask(taskId) {
                console.log(`Adding subtask to task ${taskId}`);
                // Show subtask input
            }
            
            function togglePinTask(taskId) {
                console.log(`Toggling pin for task ${taskId}`);
                // Update pinned status
            }
            
            function markWontDo(taskId) {
                console.log(`Marking task ${taskId} as "Won't Do"`);
                // Update status
            }
            
            function copyTaskLink(taskId) {
                console.log(`Copying link for task ${taskId}`);
                // Copy to clipboard
            }
            
            function convertToNote(taskId) {
                console.log(`Converting task ${taskId} to note`);
                // Convert to note
            }
        });
    </script>
</body>
</html>
